$(document).ready(function(){var e=$(window),s=$(document),t=[.02,.01,.47,1];function i(){var t,i,o;svg4everybody(),window.viewportUnitsBuggyfill.init({force:!1,refreshDebounceWait:150,appendToBody:!0}),c(),e.on("scroll",throttle(c,10)),t=0,$("[js-popup]").magnificPopup({type:"inline",fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"popup-buble",callbacks:{beforeOpen:function(){t=e.scrollTop()},close:function(){e.scrollTop(t)}}}),$("[js-popup-gallery]").magnificPopup({delegate:"a",type:"image",tLoading:"Загрузка #%curr%...",mainClass:"popup-buble",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.'}}),function(){var s='<button class="slick-arrow slick-prev"><svg class="ico ico-prev"><use xlink:href="img/sprite.svg#ico-prev"></use></svg></button>',t='<button class="slick-arrow slick-next"><svg class="ico ico-next"><use xlink:href="img/sprite.svg#ico-next"></use></svg></button>';$(".js-slides-fade").slick({fade:!0,dots:!1,arrows:!1,asNavFor:".js-slides-h, .js-slides-v",cssEase:"cubic-bezier(0.645, 0.045, 0.355, 1)",mobileFirst:!0,responsive:[{breakpoint:1200,settings:{arrows:!1,dots:!0}}]}),$(".js-slides-v").slick({fade:!0,arrows:!0,swipe:!1,asNavFor:".js-slides-fade, .js-slides-h",mobileFirst:!0,cssEase:"cubic-bezier(0.645, 0.045, 0.355, 1)",nextArrow:s,prevArrow:t,responsive:[{breakpoint:767,settings:{arrows:!1}},{breakpoint:1200,settings:{arrows:!1,dots:!1}}]}),$(".js-slides-v").on("beforeChange",function(e,s,t,i){$(s.$slides[t]).addClass("slick-removing")}),$(".js-slides-v").on("afterChange",function(e,s,t,i){$(".slides-v .slick-slide").removeClass("slick-removing")}),$(".js-slides-h").slick({arrows:!1,dots:!0,asNavFor:".js-slides-fade, .js-slides-v",mobileFirst:!0,cssEase:"cubic-bezier(0.645, 0.045, 0.355, 1)",nextArrow:s,prevArrow:t,responsive:[{breakpoint:767,settings:{arrows:!0}},{breakpoint:1200,settings:{dots:!1,arrows:!0}}]}),$(".js-slides-portfolio").slick({fade:!0,dots:!1,arrows:!0,cssEase:"ease",nextArrow:s,prevArrow:t});var i=$(".js-slides-contacts"),o={arrows:!0,dots:!0,mobileFirst:!0,cssEase:"cubic-bezier(0.645, 0.045, 0.355, 1)",nextArrow:s,prevArrow:t,responsive:[{breakpoint:767,settings:{arrows:!0}},{breakpoint:992,settings:"unslick"}]};i.slick(o),e.on("resize",debounce(function(s){if(!(e.width()>992))return i.hasClass("slick-initialized")?void 0:i.slick(o);i.hasClass("slick-initialized")&&i.slick("unslick")},300)),$(".js-gallery-slides").slick({slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!0,asNavFor:".js-gallery-thumbs"}),$(".js-gallery-thumbs").slick({vertical:!0,slidesToShow:4,slidesToScroll:1,asNavFor:".js-gallery-slides",arrows:!1,centerMode:!1,focusOnSelect:!0,mobileFirst:!0,responsive:[{breakpoint:767,settings:{slidesToShow:5}}]})}(),$(".js-dateMask").mask("99.99.99",{placeholder:"ДД.ММ.ГГ"}),$("input[type='tel']").mask("+7 (000) 000-00-00"),$(".js-readmore").readmore({speed:75,moreLink:'<a href="#" class="btn btn--collapse">развернуть текст</a>',lessLink:'<a href="#" class="btn btn--collapse">свернуть текст</a>'}),u(),e.on("resize",debounce(u,200)),h(),e.on("resize",debounce(h,200)),$(".wow").each(function(e,s){var t,i=scrollMonitor.create($(s));t=$(window).width()<768?0:$(s).data("animation-delay");var o=$(s).data("animation-class")||"wowFadeUp",a=$(s).data("animation-name")||"wowFade";i.enterViewport(throttle(function(){$(s).addClass(o),$(s).css({"animation-name":a,"animation-delay":t,visibility:"visible"})},100,{leading:!0})),i.exitViewport(throttle(function(){$(s).removeClass(o),$(s).css({"animation-name":"none","animation-delay":0,visibility:"hidden"})},100))}),s.find("[js-lazy]").Lazy({threshold:500,enableThrottle:!0,throttle:100,scrollDirection:"vertical",effect:"fadeIn",effectTime:350,onError:function(e){console.log("error loading "+e.data("src"))},beforeLoad:function(e){}}),function(){if($("#contacts__map").length){var e=new google.maps.Map(document.getElementById("contacts__map"),{center:{lat:54.3181598,lng:48.3837915},zoom:4,disableDefaultUI:!0,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#636363"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#fffcf2"}]},{featureType:"water",elementType:"all",stylers:[{color:"#aad3e6"},{visibility:"on"}]}]});new google.maps.Marker({position:new google.maps.LatLng(55.797139,37.6093601),map:e,icon:{url:"img/pin.png",scaledSize:new google.maps.Size(44,60)}}),new google.maps.Marker({position:new google.maps.LatLng(59.854462,30.4811287),map:e,icon:{url:"img/pin.png",scaledSize:new google.maps.Size(44,60)}}),new google.maps.Marker({position:new google.maps.LatLng(51.174037,71.4223829),map:e,icon:{url:"img/pin.png",scaledSize:new google.maps.Size(44,60)}})}}(),$("[js-teleport]").each(function(s,t){var i=$(t),o=$(t).html(),a=$("[data-teleport-target="+$(t).data("teleport-to")+"]"),n=$(t).data("teleport-condition").substring(1),r=$(t).data("teleport-condition").substring(0,1);if(a&&o&&r){function l(){var s;"<"===r?s=e.width()<n:">"===r&&(s=e.width()>n),s?(a.html(o),i.html("")):(i.html(o),a.html(""))}l(),e.on("resize",debounce(l,100))}}),(i=$(".js-toggle-body-class").data("class"))&&$("body").addClass(i),e.on("resize",debounce(f,200)),((o=window.location.host.toLowerCase()).indexOf("localhost")>=0||o.indexOf("surge")>=0)&&($("body").addClass("is-dev-env"),s.on("click","[js-pixelPerfect]",function(e){var s=$(this).data("target");$(this).toggleClass("is-active"),$(s).siblings().removeClass("is-active"),$(s).toggleClass("is-active")}).on("click","[js-pixelPerfectInvert]",function(e){$(this).toggleClass("is-active"),$("body").toggleClass("grid-inverted")}))}i();var o,a,n;r();function r(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function l(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))}function c(){e.scrollTop()>0?$("html").addClass("is-headerFixed"):$("html").removeClass("is-headerFixed")}function d(){$(".search__results").slideUp("fast"),$(".search__notfind").slideUp("fast"),$(".search__dropdown").slideUp("fast")}function u(){s.find(".product").each(function(s,t){var i=$(t).find(".product__desc"),o=0;i.find("li").each(function(e,s){o+=$(s).height()});var a=40;e.width()<768&&(a=30);var n=Math.abs(parseInt($(i).css("top")))+$(t).find(".product__image").outerHeight()+parseInt($(t).find(".product__image").css("margin-bottom"))+$(t).find(".product__title").height()+$(t).find(".product__price").height()+22;i.css({"padding-top":n,bottom:"-"+(2*a+o)+"px"})})}function h(){var e=$(".sku-info"),s=$(".sku-info__text div:nth-child(2)");if(e.length>0&&s.length>0){var t=e.offset().left,i=s.offset().left+parseInt(s.css("paddingLeft").slice(0,-1)),o=Math.abs(i-t);console.log(t,i,o),e.css({"padding-left":Math.floor(o)})}}l()&&$("body").addClass("is-ie"),r()&&$("body").addClass("is-mobile"),/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)&&$("body").addClass("is-chrome"),s.on("click",'[href="#"]',function(e){e.preventDefault()}).on("click",'a[href^="#section"]',function(){var e=$(this).attr("href");return $("body, html").animate({scrollTop:$(e).offset().top},1e3),!1}),s.on("click",".js-nav-trigger",function(e){e.preventDefault(),$("html").is(".is-navOpen")?($("html").removeClass("is-navOpen"),$(".js-nav-collapse").slideUp("fast")):($("html").addClass("is-navOpen"),$(".js-nav-collapse").slideDown("fast"))}).on("click",function(e){0==$(e.target).closest(".nav, .btn--nav").length&&($("html").removeClass("is-navOpen"),$(".js-nav-collapse").slideUp("fast"))}),s.on("click",".js-search-open",function(e){e.preventDefault(),$("html").is(".is-search-open")?$("html").removeClass("is-search-open"):($("html").addClass("is-search-open"),$(".js-search-input").focus())}),s.on("click",".js-search-clear",function(e){e.preventDefault(),$(".js-search").find("form").trigger("reset"),$("html").removeClass("is-search-keyup is-search-found is-search-notfound"),d()}),s.on("click",function(e){0==$(e.target).closest(".js-search").length&&($("html").removeClass("is-search-open is-search-keyup is-search-found is-search-notfound"),d())}),$(".js-search-input").on("input",debounce(function(e){var s=this.value.toLowerCase(),t=this.value.length;t>=1?($("html").addClass("is-search-keyup"),$(".js-search-progress").width(0).stop().animate({width:"100%"},1e3,function(){$(".js-search-progress").width(0),$(".search__item-name").each(function(){var e=$(this).text(),i=e.toLowerCase(),o="<mark>"+e.substr(0,t)+"</mark>"+e.substr(t);0==i.indexOf(s)?$(this).html(o).closest("li").addClass("is-visible"):$(this).html(o).closest("li").removeClass("is-visible");$(".search__item-name").closest("li").length;0==$(".search__item-name").closest("li.is-visible").length?($(".search__results").slideUp("fast"),$(".search__notfind").slideDown("fast"),$(".search__dropdown").slideDown("fast")):($(".search__results").slideDown("fast"),$(".search__notfind").slideUp("fast"),$(".search__dropdown").slideDown("fast"))})})):($("html").removeClass("is-search-keyup is-search-found is-search-notfound"),d(),$(".js-search-progress").stop().width(0))},200)),s.on("click",".catalog__sorting-btn",function(e){e.preventDefault(),$("html").is(".is-sorting-open")?$("html").removeClass("is-sorting-open"):$("html").addClass("is-sorting-open")}),s.on("change","[name=sorting]",function(e){$("html").removeClass("is-sorting-open");var s=$(this).val();$(".catalog__sorting-selected").text(s)}),s.on("click",".js-filter-trigger",function(e){e.preventDefault(),$("html").is(".is-filter-open")?$("html").removeClass("is-filter-open"):$("html").addClass("is-filter-open")}),s.on("mouseenter",".js-categories-trigger, .catalog__categories",function(){$("html").addClass("is-categories-open")}),s.on("mouseleave",".js-categories-trigger, .catalog__categories",function(){$("html").removeClass("is-categories-open")}),s.on("click",".js-categories-trigger",function(e){e.preventDefault(),$("html").is(".is-categories-open-fixed")?$("html").removeClass("is-categories-open-fixed"):$("html").addClass("is-categories-open-fixed")}),s.on("click",function(e){0==$(e.target).closest(".catalog__categories, .js-categories-trigger").length&&($("html").removeClass("is-categories-open"),$("html").removeClass("is-categories-open-fixed"))}),s.on("click",function(e){0==$(e.target).closest(".catalog__sorting").length&&$("html").removeClass("is-sorting-open")}),s.on("click","[js-showAllCheckboxes]",function(e){var s=$(this).is(".is-opened")?$(this).data("text-more"):$(this).data("text-less");$(this).toggleClass("is-opened"),$("[js-hiddenCheckboxes]").slideToggle(),$(this).find(".btn").text(s),e.preventDefault()}),$(".ui__input, .ui__textarea").on("focus blur",function(e){$(this).parents(".ui__group").toggleClass("is-focused","focus"===e.type||this.value.length>0)}).trigger("blur"),s.on("click",".btn--load",function(){var e=$(this);e.addClass("is-loading"),setTimeout(function(){e.removeClass("is-loading")},1500)}),s.on("click",".js-sku-trigger",function(e){e.preventDefault(),$("html").is(".is-sku-open")?$("html").removeClass("is-sku-open"):$("html").addClass("is-sku-open")}),o=function(e){u()},XMLHttpRequest.callbacks?XMLHttpRequest.callbacks.push(o):(XMLHttpRequest.callbacks=[o],a=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(){for(n=0;n<XMLHttpRequest.callbacks.length;n++)XMLHttpRequest.callbacks[n](this);a.apply(this,arguments)}),Barba.Pjax.Dom.containerClass="page";var p=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){var e=Barba.Utils.deferred();return anime({targets:this.oldContainer,opacity:.5,easing:t,duration:300,complete:function(s){e.resolve()}}),e.promise},fadeIn:function(){var e=this,s=$(this.newContainer);$(this.oldContainer).hide(),s.css({visibility:"visible",opacity:.5}),anime({targets:"html, body",scrollTop:0,easing:t,duration:150}),anime({targets:this.newContainer,opacity:1,easing:t,duration:300,complete:function(s){$(window).scroll(),$(window).resize(),e.done()}})}});function f(){var s=window.location.host.toLowerCase();if(s.indexOf("localhost")>=0||s.indexOf("surge")>=0){var t="<div class='dev-bp-debug'>"+e.width()+"</div>";$(".page").append(t),setTimeout(function(){$(".dev-bp-debug").fadeOut()},1e3),setTimeout(function(){$(".dev-bp-debug").remove()},1500)}}Barba.Pjax.getTransition=function(){return p},Barba.Prefetch.init(),Barba.Pjax.start(),Barba.Dispatcher.on("newPageReady",function(e,s,t,o){var a=o.replace(/(<\/?)body( .+?)?>/gi,"$1notbody$2>",o),n=$(a).filter("notbody").attr("class");$("html").removeClass(),$("body").attr("class",n),i()}),$(".js-sticky").each(function(s,t){var i,o,a,n,r,l,c,d,u=0,h=0;function p(){i=$(t),o=i.height(),a=i.parent(),n={top:a.offset().top,left:a.offset().left,height:a.height(),width:a.outerWidth()},r=e.height(),c=Math.floor(n.top),l=Math.floor(n.top+o-r),d=Math.floor(c+n.height-r),f()}function f(){var s=e.scrollTop(),t=u>=s?"up":"down";if(e.width()>992){var a={position:"",bottom:"",top:"",width:"",marginTop:"",classFixed:""};s>c?(a.classFixed="is-fixed",a.width=n.width,s>l?(a.position="fixed",a.bottom=0,s>d&&(a.position="absolute",a.classFixed="")):a.position="static","up"==t&&s<d&&(0==h&&(h=u),s<h&&(a.position="static",a.marginTop=h+r-c-o),s<h-(o-r)&&(a.position="fixed",a.top=0,a.marginTop=0,a.bottom="auto"))):a.classFixed="",i.css(a),u=s}else i.attr("style","")}p(),e.on("scroll",throttle(f,5)),e.on("resize",debounce(p,250))})}),function(e){var s=0;e.fn.scrolled=function(t,i){"function"==typeof t&&(i=t,t=50);var o="scrollTimer"+s++;this.scroll(function(){var s=e(this),a=s.data(o);a&&clearTimeout(a),a=setTimeout(function(){s.removeData(o),i.call(s[0])},t),s.data(o,a)})}}(jQuery),function(e){var s=0;e.fn.resized=function(t,i){"function"==typeof t&&(i=t,t=50);var o="scrollTimer"+s++;this.resize(function(){var s=e(this),a=s.data(o);a&&clearTimeout(a),a=setTimeout(function(){s.removeData(o),i.call(s[0])},t),s.data(o,a)})}}(jQuery),$(document).one("focus.autoExpand","textarea.autoExpand",function(){var e=this.value;this.value="",this.baseScrollHeight=this.scrollHeight,this.value=e}).on("input.autoExpand","textarea.autoExpand",function(){var e,s=0|this.getAttribute("data-min-rows");this.rows=s,e=Math.ceil((this.scrollHeight-this.baseScrollHeight)/17),this.rows=s+e}),$(document).ready(function(){$.validator.addMethod("regexp",function(e,s){return this.optional(s)||/^\+\d \(\d{3}\) \d{3}-\d{2}-\d{2}$/.test(e)});var e=function(){$(".js-validate").find(".is-error").length>0?$(".js-validate").addClass("is-invalid"):$(".js-validate").removeClass("is-invalid")};$(".js-validate").validate({errorClass:"is-error",ignore:":disabled,:hidden",highlight:function(s){$(s).addClass("is-error"),e()},unhighlight:function(s){$(s).removeClass("is-error"),e()},rules:{name:{required:!0},tel:{required:!0,regexp:!0},email:{required:!0,email:!0},message:{required:!0}},errorPlacement:function(e,s){return!0},submitHandler:function(e){return $(e).addClass("is-valid"),setTimeout(function(){$(".js-validate").trigger("reset").removeClass("is-valid").find(".ui__group").removeClass("is-focused")},2e3),console.log("Отправили!"),!1}})});